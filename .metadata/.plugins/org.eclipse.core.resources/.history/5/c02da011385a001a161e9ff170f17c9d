-- @atlcompiler emftvm

module PetriNet2PNML_TM_Mutant8;
create OUT : PNML from IN : PetriNet;

-- The PNMLDocument rule generates a PNMLDocument  and the NetElement which corresponds to the input PetriNet element. 
-- Name of the generated NetElement is copied from the one of the input PetriNet, by creating a PNML Name composed of a PNML Label which value is initialized by the PetriNet name.
-- Its set of Contents corresponds to the union of the PetriNet Elements and Arcs.
rule PNMLDocument {
    from
        e : PetriNet!PetriNet
    to    
        n : PNML!TM_PNMLDocument
        (
            location <- e.location,
            xmlns <- uri,
            nets <- Sequence{net}            
        ),
        uri : PNML!TM_URI
        (
            value <- 'http://www.informatik.hu-berlin.de/top/pnml/ptNetb'
        ),
        net : PNML!TM_NetElement
        (
            name <- name,
            location <- e.location,
            id <- e.location,
            type <- type_uri,
            contents <- e.elements.union(e.arcs)
        ),
        name : PNML!TM_Name
        (
            labels <- Sequence{label},
			location <- e.location
        ),
        label : PNML!TM_Label
        (
            text <- e.name
        ),
        type_uri : PNML!TM_URI
        (
            value <- 'http://www.informatik.hu-berlin.de/top/pntd/ptNetb'
        )
}

-- The Place rule generates a Place corresponds to the input PetriNet Place element. 
-- Name of the generated Place is copied from the one of the input Place, by creating a PNML Name composed of a PNML Label which value is initialized by the PetriNet Place name.
rule Place {
    from
        e : PetriNet!Place
    to
        n : PNML!TM_Place
        (
            name <- name,
            location <- e.name, -- These two bindings have been swapped
            id <- e.location -- These two bindings have been swapped           
        ),
        name : PNML!TM_Name
        (
            labels <- Sequence{label}
        ),
        label : PNML!TM_Label
        (
            text <- e.name
        )
}

-- The Transition rule generates a Transition corresponds to the input PetriNet Transition element. 
-- Name of the generated Transition is copied from the one of the input Transition, by creating a PNML Name composed of a PNML Label which value is initialized by the PetriNet Transition name.
rule Transition {
    from
        e : PetriNet!Transition
    to
        n : PNML!TM_Transition
        (
            name <- name,
            location <- e.name, -- These two bindings have been swapped
            id <- e.location -- These two bindings have been swapped   
        ),
        name : PNML!TM_Name
        (
            labels <- Sequence{label}
        ),
        label : PNML!TM_Label
        (
            text <- e.name
        )
}

-- The Arc rule generates a Arc corresponds to the input PetriNet Arc element (TransitionToPlace and PlaceToTransition). 
-- Name of the generated Arc is copied from the one of the input Arc, by creating a PNML Name composed of a PNML Label which value is initialized by the PetriNet Arc name.
-- Its source and target references are also copied from the input Arc and correspond respectively to the from and to references.
rule Arc {
    from
        e : PetriNet!Arc
    to
        n : PNML!TM_Arc
        (
            name <- name,
            location <- e.name, -- These two bindings have been swapped
            id <- e.location, -- These two bindings have been swapped   
            source <- e."from",
            target <- e."to" 
        ),
        name : PNML!TM_Name
        (
            labels <- Sequence{label}
        ),
        label : PNML!TM_Label
        (
            text <- e.name
        )
}